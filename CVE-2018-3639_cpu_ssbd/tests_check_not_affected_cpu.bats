#!/usr/bin/env bats

. test_harness

@test "check_not_affected_cpu -- all affected" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/all_affected

    run check_not_affected_cpu
    (( status == 1 ))
}


@test "check_not_affected_cpu -- all not affected" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/all_not_affected

    run check_not_affected_cpu
    (( status == 0 ))
}


@test "check_not_affected_cpu -- some affected" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/some_affected

    run check_not_affected_cpu
    (( status == 1 ))
}


@test "check_not_affected_cpu -- s390 affected" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/s390

    run check_not_affected_cpu
    (( status == 1 ))
}


@test "check_not_affected_cpu -- power affected" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/power

    run check_not_affected_cpu
    (( status == 1 ))
}
