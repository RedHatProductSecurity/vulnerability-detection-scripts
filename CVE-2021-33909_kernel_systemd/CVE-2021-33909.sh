#!/bin/bash

# Copyright (c) 2021  Red Hat, Inc.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.

VERSION="1.1"

# Updates
# Version 1.1: Add updated kpatch versions

# Warning! Be sure to download the latest version of this script from its primary source:

BULLETIN="https://access.redhat.com/security/vulnerabilities/RHSB-2021-006"

# DO NOT blindly trust any internet sources and NEVER do `curl something | bash`!

# This script is meant for simple detection of the vulnerability. Feel free to modify it for your
# environment or needs. For more advanced detection, consider Red Hat Insights:
# https://access.redhat.com/products/red-hat-insights#getstarted

# Checking against the list of vulnerable packages is necessary because of the way how features
# are back-ported to older versions of packages in various channels.

# Exit codes:
#
# 1 - Unsupported platform or missing requirements
# 2 - Kernel version is vulnerable
# 4 - Systemd version is vulnerable
# 6 - Kernel and systemd versions are vulnerable


VULNERABLE_VERSIONS_KERNEL=(
    'kernel-2.6.32-71.7.1.el6'
    'kernel-2.6.32-71.14.1.el6'
    'kernel-2.6.32-71.18.1.el6'
    'kernel-2.6.32-71.18.2.el6'
    'kernel-2.6.32-71.24.1.el6'
    'kernel-2.6.32-71.29.1.el6'
    'kernel-2.6.32-71.el6'
    'kernel-2.6.32-131.0.15.el6'
    'kernel-2.6.32-131.2.1.el6'
    'kernel-2.6.32-131.4.1.el6'
    'kernel-2.6.32-131.6.1.el6'
    'kernel-2.6.32-131.12.1.el6'
    'kernel-2.6.32-131.17.1.el6'
    'kernel-2.6.32-131.21.1.el6'
    'kernel-2.6.32-131.22.1.el6'
    'kernel-2.6.32-131.25.1.el6'
    'kernel-2.6.32-131.26.1.el6'
    'kernel-2.6.32-131.28.1.el6'
    'kernel-2.6.32-131.29.1.el6'
    'kernel-2.6.32-131.30.1.el6'
    'kernel-2.6.32-131.30.2.el6'
    'kernel-2.6.32-131.33.1.el6'
    'kernel-2.6.32-131.35.1.el6'
    'kernel-2.6.32-131.36.1.el6'
    'kernel-2.6.32-131.37.1.el6'
    'kernel-2.6.32-131.38.1.el6'
    'kernel-2.6.32-131.39.1.el6'
    'kernel-2.6.32-220.2.1.el6'
    'kernel-2.6.32-220.4.1.el6'
    'kernel-2.6.32-220.4.2.el6'
    'kernel-2.6.32-220.4.4.bgq.el6'
    'kernel-2.6.32-220.4.7.bgq.el6'
    'kernel-2.6.32-220.7.1.el6'
    'kernel-2.6.32-220.7.2.p7ih.el6'
    'kernel-2.6.32-220.7.3.p7ih.el6'
    'kernel-2.6.32-220.7.4.p7ih.el6'
    'kernel-2.6.32-220.7.6.p7ih.el6'
    'kernel-2.6.32-220.7.7.p7ih.el6'
    'kernel-2.6.32-220.13.1.el6'
    'kernel-2.6.32-220.17.1.el6'
    'kernel-2.6.32-220.23.1.el6'
    'kernel-2.6.32-220.24.1.el6'
    'kernel-2.6.32-220.25.1.el6'
    'kernel-2.6.32-220.26.1.el6'
    'kernel-2.6.32-220.28.1.el6'
    'kernel-2.6.32-220.30.1.el6'
    'kernel-2.6.32-220.31.1.el6'
    'kernel-2.6.32-220.32.1.el6'
    'kernel-2.6.32-220.34.1.el6'
    'kernel-2.6.32-220.34.2.el6'
    'kernel-2.6.32-220.38.1.el6'
    'kernel-2.6.32-220.39.1.el6'
    'kernel-2.6.32-220.41.1.el6'
    'kernel-2.6.32-220.42.1.el6'
    'kernel-2.6.32-220.45.1.el6'
    'kernel-2.6.32-220.46.1.el6'
    'kernel-2.6.32-220.48.1.el6'
    'kernel-2.6.32-220.51.1.el6'
    'kernel-2.6.32-220.52.1.el6'
    'kernel-2.6.32-220.53.1.el6'
    'kernel-2.6.32-220.54.1.el6'
    'kernel-2.6.32-220.55.1.el6'
    'kernel-2.6.32-220.56.1.el6'
    'kernel-2.6.32-220.57.1.el6'
    'kernel-2.6.32-220.58.1.el6'
    'kernel-2.6.32-220.60.2.el6'
    'kernel-2.6.32-220.62.1.el6'
    'kernel-2.6.32-220.63.2.el6'
    'kernel-2.6.32-220.64.1.el6'
    'kernel-2.6.32-220.65.1.el6'
    'kernel-2.6.32-220.66.1.el6'
    'kernel-2.6.32-220.67.1.el6'
    'kernel-2.6.32-220.68.1.el6'
    'kernel-2.6.32-220.69.1.el6'
    'kernel-2.6.32-220.70.1.el6'
    'kernel-2.6.32-220.71.1.el6'
    'kernel-2.6.32-220.72.2.el6'
    'kernel-2.6.32-220.73.1.el6'
    'kernel-2.6.32-220.75.1.el6'
    'kernel-2.6.32-220.76.1.el6'
    'kernel-2.6.32-220.76.2.el6'
    'kernel-2.6.32-220.77.1.el6'
    'kernel-2.6.32-220.el6'
    'kernel-2.6.32-279.1.1.el6'
    'kernel-2.6.32-279.2.1.el6'
    'kernel-2.6.32-279.5.1.el6'
    'kernel-2.6.32-279.5.2.el6'
    'kernel-2.6.32-279.9.1.el6'
    'kernel-2.6.32-279.11.1.el6'
    'kernel-2.6.32-279.14.1.bgq.el6'
    'kernel-2.6.32-279.14.1.el6'
    'kernel-2.6.32-279.19.1.el6'
    'kernel-2.6.32-279.22.1.el6'
    'kernel-2.6.32-279.23.1.el6'
    'kernel-2.6.32-279.25.1.el6'
    'kernel-2.6.32-279.25.2.el6'
    'kernel-2.6.32-279.31.1.el6'
    'kernel-2.6.32-279.33.1.el6'
    'kernel-2.6.32-279.34.1.el6'
    'kernel-2.6.32-279.37.2.el6'
    'kernel-2.6.32-279.39.1.el6'
    'kernel-2.6.32-279.41.1.el6'
    'kernel-2.6.32-279.42.1.el6'
    'kernel-2.6.32-279.43.1.el6'
    'kernel-2.6.32-279.43.2.el6'
    'kernel-2.6.32-279.46.1.el6'
    'kernel-2.6.32-279.el6'
    'kernel-2.6.32-358.0.1.el6'
    'kernel-2.6.32-358.2.1.el6'
    'kernel-2.6.32-358.6.1.el6'
    'kernel-2.6.32-358.6.2.el6'
    'kernel-2.6.32-358.6.3.p7ih.el6'
    'kernel-2.6.32-358.11.1.bgq.el6'
    'kernel-2.6.32-358.11.1.el6'
    'kernel-2.6.32-358.14.1.el6'
    'kernel-2.6.32-358.18.1.el6'
    'kernel-2.6.32-358.23.2.el6'
    'kernel-2.6.32-358.28.1.el6'
    'kernel-2.6.32-358.32.3.el6'
    'kernel-2.6.32-358.37.1.el6'
    'kernel-2.6.32-358.41.1.el6'
    'kernel-2.6.32-358.44.1.el6'
    'kernel-2.6.32-358.46.1.el6'
    'kernel-2.6.32-358.46.2.el6'
    'kernel-2.6.32-358.48.1.el6'
    'kernel-2.6.32-358.49.1.el6'
    'kernel-2.6.32-358.51.1.el6'
    'kernel-2.6.32-358.51.2.el6'
    'kernel-2.6.32-358.55.1.el6'
    'kernel-2.6.32-358.56.1.el6'
    'kernel-2.6.32-358.59.1.el6'
    'kernel-2.6.32-358.61.1.el6'
    'kernel-2.6.32-358.62.1.el6'
    'kernel-2.6.32-358.65.1.el6'
    'kernel-2.6.32-358.67.1.el6'
    'kernel-2.6.32-358.68.1.el6'
    'kernel-2.6.32-358.69.1.el6'
    'kernel-2.6.32-358.70.1.el6'
    'kernel-2.6.32-358.71.1.el6'
    'kernel-2.6.32-358.72.1.el6'
    'kernel-2.6.32-358.73.1.el6'
    'kernel-2.6.32-358.75.1.el6'
    'kernel-2.6.32-358.76.1.el6'
    'kernel-2.6.32-358.77.1.el6'
    'kernel-2.6.32-358.78.1.el6'
    'kernel-2.6.32-358.79.1.el6'
    'kernel-2.6.32-358.79.2.el6'
    'kernel-2.6.32-358.81.1.el6'
    'kernel-2.6.32-358.82.1.el6'
    'kernel-2.6.32-358.83.1.el6'
    'kernel-2.6.32-358.84.1.el6'
    'kernel-2.6.32-358.84.2.el6'
    'kernel-2.6.32-358.85.1.el6'
    'kernel-2.6.32-358.87.1.el6'
    'kernel-2.6.32-358.88.2.el6'
    'kernel-2.6.32-358.88.4.el6'
    'kernel-2.6.32-358.90.1.el6'
    'kernel-2.6.32-358.91.4.el6'
    'kernel-2.6.32-358.93.1.el6'
    'kernel-2.6.32-358.94.1.el6'
    'kernel-2.6.32-358.95.1.el6'
    'kernel-2.6.32-358.111.1.openstack.el6'
    'kernel-2.6.32-358.114.1.openstack.el6'
    'kernel-2.6.32-358.118.1.openstack.el6'
    'kernel-2.6.32-358.123.4.openstack.el6'
    'kernel-2.6.32-358.el6'
    'kernel-2.6.32-431.1.1.bgq.el6'
    'kernel-2.6.32-431.1.2.el6'
    'kernel-2.6.32-431.3.1.el6'
    'kernel-2.6.32-431.5.1.el6'
    'kernel-2.6.32-431.11.2.el6'
    'kernel-2.6.32-431.17.1.el6'
    'kernel-2.6.32-431.20.3.el6'
    'kernel-2.6.32-431.20.5.el6'
    'kernel-2.6.32-431.23.3.el6'
    'kernel-2.6.32-431.29.2.el6'
    'kernel-2.6.32-431.37.1.el6'
    'kernel-2.6.32-431.40.1.el6'
    'kernel-2.6.32-431.40.2.el6'
    'kernel-2.6.32-431.46.2.el6'
    'kernel-2.6.32-431.50.1.el6'
    'kernel-2.6.32-431.53.2.el6'
    'kernel-2.6.32-431.56.1.el6'
    'kernel-2.6.32-431.59.1.el6'
    'kernel-2.6.32-431.61.2.el6'
    'kernel-2.6.32-431.64.1.el6'
    'kernel-2.6.32-431.66.1.el6'
    'kernel-2.6.32-431.68.1.el6'
    'kernel-2.6.32-431.69.1.el6'
    'kernel-2.6.32-431.70.1.el6'
    'kernel-2.6.32-431.71.1.el6'
    'kernel-2.6.32-431.72.1.el6'
    'kernel-2.6.32-431.73.2.el6'
    'kernel-2.6.32-431.74.1.el6'
    'kernel-2.6.32-431.75.1.el6'
    'kernel-2.6.32-431.76.1.el6'
    'kernel-2.6.32-431.77.1.el6'
    'kernel-2.6.32-431.78.1.el6'
    'kernel-2.6.32-431.79.1.el6'
    'kernel-2.6.32-431.80.1.el6'
    'kernel-2.6.32-431.80.2.el6'
    'kernel-2.6.32-431.81.2.el6'
    'kernel-2.6.32-431.81.3.el6'
    'kernel-2.6.32-431.82.1.el6'
    'kernel-2.6.32-431.84.1.el6'
    'kernel-2.6.32-431.85.1.el6'
    'kernel-2.6.32-431.85.2.el6'
    'kernel-2.6.32-431.86.1.el6'
    'kernel-2.6.32-431.87.1.el6'
    'kernel-2.6.32-431.89.2.el6'
    'kernel-2.6.32-431.89.4.el6'
    'kernel-2.6.32-431.90.1.el6'
    'kernel-2.6.32-431.91.3.el6'
    'kernel-2.6.32-431.93.2.el6'
    'kernel-2.6.32-431.94.1.el6'
    'kernel-2.6.32-431.94.2.el6'
    'kernel-2.6.32-431.95.3.el6'
    'kernel-2.6.32-431.96.1.el6'
    'kernel-2.6.32-431.96.2.el6'
    'kernel-2.6.32-431.96.3.el6'
    'kernel-2.6.32-431.97.1.el6'
    'kernel-2.6.32-431.98.1.el6'
    'kernel-2.6.32-431.el6'
    'kernel-2.6.32-504.1.3.el6'
    'kernel-2.6.32-504.3.3.el6'
    'kernel-2.6.32-504.8.1.el6'
    'kernel-2.6.32-504.8.2.bgq.el6'
    'kernel-2.6.32-504.12.2.el6'
    'kernel-2.6.32-504.16.2.el6'
    'kernel-2.6.32-504.23.4.el6'
    'kernel-2.6.32-504.30.3.el6'
    'kernel-2.6.32-504.30.5.p7ih.el6'
    'kernel-2.6.32-504.30.6.p7ih.el6'
    'kernel-2.6.32-504.33.2.el6'
    'kernel-2.6.32-504.36.1.el6'
    'kernel-2.6.32-504.38.1.el6'
    'kernel-2.6.32-504.40.1.el6'
    'kernel-2.6.32-504.43.1.el6'
    'kernel-2.6.32-504.46.1.el6'
    'kernel-2.6.32-504.49.1.el6'
    'kernel-2.6.32-504.50.1.el6'
    'kernel-2.6.32-504.51.1.el6'
    'kernel-2.6.32-504.52.1.el6'
    'kernel-2.6.32-504.54.1.el6'
    'kernel-2.6.32-504.55.1.el6'
    'kernel-2.6.32-504.56.1.el6'
    'kernel-2.6.32-504.57.1.el6'
    'kernel-2.6.32-504.58.1.el6'
    'kernel-2.6.32-504.60.2.el6'
    'kernel-2.6.32-504.60.3.el6'
    'kernel-2.6.32-504.62.1.el6'
    'kernel-2.6.32-504.63.2.el6'
    'kernel-2.6.32-504.63.3.el6'
    'kernel-2.6.32-504.64.1.el6'
    'kernel-2.6.32-504.64.4.el6'
    'kernel-2.6.32-504.65.1.el6'
    'kernel-2.6.32-504.66.1.el6'
    'kernel-2.6.32-504.68.2.el6'
    'kernel-2.6.32-504.69.3.el6'
    'kernel-2.6.32-504.71.1.el6'
    'kernel-2.6.32-504.72.1.el6'
    'kernel-2.6.32-504.72.4.el6'
    'kernel-2.6.32-504.76.2.el6'
    'kernel-2.6.32-504.78.1.el6'
    'kernel-2.6.32-504.78.2.el6'
    'kernel-2.6.32-504.79.3.el6'
    'kernel-2.6.32-504.80.2.el6'
    'kernel-2.6.32-504.81.2.el6'
    'kernel-2.6.32-504.81.3.el6'
    'kernel-2.6.32-504.82.1.el6'
    'kernel-2.6.32-504.83.1.el6'
    'kernel-2.6.32-504.84.1.el6'
    'kernel-2.6.32-504.el6'
    'kernel-2.6.32-572.el6'
    'kernel-2.6.32-573.1.1.el6'
    'kernel-2.6.32-573.3.1.el6'
    'kernel-2.6.32-573.4.2.bgq.el6'
    'kernel-2.6.32-573.7.1.el6'
    'kernel-2.6.32-573.8.1.el6'
    'kernel-2.6.32-573.12.1.el6'
    'kernel-2.6.32-573.18.1.el6'
    'kernel-2.6.32-573.22.1.el6'
    'kernel-2.6.32-573.26.1.el6'
    'kernel-2.6.32-573.30.1.el6'
    'kernel-2.6.32-573.32.1.el6'
    'kernel-2.6.32-573.34.1.el6'
    'kernel-2.6.32-573.35.1.el6'
    'kernel-2.6.32-573.35.2.el6'
    'kernel-2.6.32-573.37.1.el6'
    'kernel-2.6.32-573.38.1.el6'
    'kernel-2.6.32-573.40.1.el6'
    'kernel-2.6.32-573.41.1.el6'
    'kernel-2.6.32-573.42.1.el6'
    'kernel-2.6.32-573.42.2.el6'
    'kernel-2.6.32-573.43.2.el6'
    'kernel-2.6.32-573.43.3.el6'
    'kernel-2.6.32-573.45.1.el6'
    'kernel-2.6.32-573.45.2.el6'
    'kernel-2.6.32-573.47.1.el6'
    'kernel-2.6.32-573.48.1.el6'
    'kernel-2.6.32-573.49.1.el6'
    'kernel-2.6.32-573.49.3.el6'
    'kernel-2.6.32-573.51.1.el6'
    'kernel-2.6.32-573.53.1.el6'
    'kernel-2.6.32-573.55.2.el6'
    'kernel-2.6.32-573.55.4.el6'
    'kernel-2.6.32-573.59.1.el6'
    'kernel-2.6.32-573.60.1.el6'
    'kernel-2.6.32-573.60.4.el6'
    'kernel-2.6.32-573.62.1.el6'
    'kernel-2.6.32-573.65.2.el6'
    'kernel-2.6.32-573.el6'
    'kernel-2.6.32-642.1.1.el6'
    'kernel-2.6.32-642.3.1.el6'
    'kernel-2.6.32-642.4.2.el6'
    'kernel-2.6.32-642.6.1.el6'
    'kernel-2.6.32-642.6.2.el6'
    'kernel-2.6.32-642.11.1.el6'
    'kernel-2.6.32-642.13.1.el6'
    'kernel-2.6.32-642.13.2.el6'
    'kernel-2.6.32-642.15.1.el6'
    'kernel-2.6.32-642.el6'
    'kernel-2.6.32-682.el6'
    'kernel-2.6.32-683.el6'
    'kernel-2.6.32-696.1.1.bgq.el6'
    'kernel-2.6.32-696.1.1.el6'
    'kernel-2.6.32-696.3.1.el6'
    'kernel-2.6.32-696.3.2.el6'
    'kernel-2.6.32-696.6.3.el6'
    'kernel-2.6.32-696.10.1.el6'
    'kernel-2.6.32-696.10.2.el6'
    'kernel-2.6.32-696.10.3.el6'
    'kernel-2.6.32-696.13.2.el6'
    'kernel-2.6.32-696.16.1.el6'
    'kernel-2.6.32-696.18.7.el6'
    'kernel-2.6.32-696.20.1.el6'
    'kernel-2.6.32-696.23.1.el6'
    'kernel-2.6.32-696.28.1.el6'
    'kernel-2.6.32-696.30.1.el6'
    'kernel-2.6.32-696.el6'
    'kernel-2.6.32-749.el6'
    'kernel-2.6.32-751.el6'
    'kernel-2.6.32-752.el6'
    'kernel-2.6.32-754.2.1.el6'
    'kernel-2.6.32-754.3.5.el6'
    'kernel-2.6.32-754.6.3.el6'
    'kernel-2.6.32-754.9.1.el6'
    'kernel-2.6.32-754.10.1.el6'
    'kernel-2.6.32-754.11.1.el6'
    'kernel-2.6.32-754.12.1.el6'
    'kernel-2.6.32-754.14.2.el6'
    'kernel-2.6.32-754.15.3.el6'
    'kernel-2.6.32-754.17.1.el6'
    'kernel-2.6.32-754.18.2.el6'
    'kernel-2.6.32-754.22.1.el6'
    'kernel-2.6.32-754.23.1.el6'
    'kernel-2.6.32-754.24.2.el6'
    'kernel-2.6.32-754.24.3.el6'
    'kernel-2.6.32-754.25.1.el6'
    'kernel-2.6.32-754.27.1.el6'
    'kernel-2.6.32-754.28.1.el6'
    'kernel-2.6.32-754.29.1.el6'
    'kernel-2.6.32-754.29.2.el6'
    'kernel-2.6.32-754.30.2.el6'
    'kernel-2.6.32-754.31.1.el6'
    'kernel-2.6.32-754.33.1.el6'
    'kernel-2.6.32-754.35.1.el6'
    'kernel-2.6.32-754.36.1.el6'
    'kernel-2.6.32-754.39.1.el6'
    'kernel-2.6.32-754.el6'
    'kernel-3.10.0-54.0.1.el7'
    'kernel-3.10.0-121.el7'
    'kernel-3.10.0-123.1.2.el7'
    'kernel-3.10.0-123.4.2.el7'
    'kernel-3.10.0-123.4.4.el7'
    'kernel-3.10.0-123.6.3.el7'
    'kernel-3.10.0-123.8.1.el7'
    'kernel-3.10.0-123.9.2.el7'
    'kernel-3.10.0-123.9.3.el7'
    'kernel-3.10.0-123.13.1.el7'
    'kernel-3.10.0-123.13.2.el7'
    'kernel-3.10.0-123.20.1.el7'
    'kernel-3.10.0-123.el7'
    'kernel-3.10.0-229.1.2.el7'
    'kernel-3.10.0-229.4.2.el7'
    'kernel-3.10.0-229.7.2.el7'
    'kernel-3.10.0-229.11.1.el7'
    'kernel-3.10.0-229.14.1.el7'
    'kernel-3.10.0-229.20.1.el7'
    'kernel-3.10.0-229.24.2.el7'
    'kernel-3.10.0-229.26.2.el7'
    'kernel-3.10.0-229.28.1.el7'
    'kernel-3.10.0-229.30.1.el7'
    'kernel-3.10.0-229.34.1.el7'
    'kernel-3.10.0-229.38.1.el7'
    'kernel-3.10.0-229.40.1.el7'
    'kernel-3.10.0-229.42.1.el7'
    'kernel-3.10.0-229.42.2.el7'
    'kernel-3.10.0-229.44.1.el7'
    'kernel-3.10.0-229.46.1.el7'
    'kernel-3.10.0-229.48.1.el7'
    'kernel-3.10.0-229.49.1.el7'
    'kernel-3.10.0-229.el7'
    'kernel-3.10.0-327.3.1.el7'
    'kernel-3.10.0-327.4.4.el7'
    'kernel-3.10.0-327.4.5.el7'
    'kernel-3.10.0-327.10.1.el7'
    'kernel-3.10.0-327.13.1.el7'
    'kernel-3.10.0-327.18.2.el7'
    'kernel-3.10.0-327.22.2.el7'
    'kernel-3.10.0-327.28.2.el7'
    'kernel-3.10.0-327.28.3.el7'
    'kernel-3.10.0-327.36.1.el7'
    'kernel-3.10.0-327.36.2.el7'
    'kernel-3.10.0-327.36.3.el7'
    'kernel-3.10.0-327.41.3.el7'
    'kernel-3.10.0-327.41.4.el7'
    'kernel-3.10.0-327.44.2.el7'
    'kernel-3.10.0-327.46.1.el7'
    'kernel-3.10.0-327.49.2.el7'
    'kernel-3.10.0-327.53.1.el7'
    'kernel-3.10.0-327.55.1.el7'
    'kernel-3.10.0-327.55.2.el7'
    'kernel-3.10.0-327.55.3.el7'
    'kernel-3.10.0-327.58.1.el7'
    'kernel-3.10.0-327.59.1.el7'
    'kernel-3.10.0-327.59.2.el7'
    'kernel-3.10.0-327.59.3.el7'
    'kernel-3.10.0-327.61.3.el7'
    'kernel-3.10.0-327.62.1.el7'
    'kernel-3.10.0-327.62.4.el7'
    'kernel-3.10.0-327.64.1.el7'
    'kernel-3.10.0-327.66.1.el7'
    'kernel-3.10.0-327.66.3.el7'
    'kernel-3.10.0-327.66.5.el7'
    'kernel-3.10.0-327.70.1.el7'
    'kernel-3.10.0-327.71.1.el7'
    'kernel-3.10.0-327.71.4.el7'
    'kernel-3.10.0-327.73.1.el7'
    'kernel-3.10.0-327.76.1.el7'
    'kernel-3.10.0-327.77.1.el7'
    'kernel-3.10.0-327.78.2.el7'
    'kernel-3.10.0-327.79.2.el7'
    'kernel-3.10.0-327.80.1.el7'
    'kernel-3.10.0-327.82.1.el7'
    'kernel-3.10.0-327.82.2.el7'
    'kernel-3.10.0-327.83.1.el7'
    'kernel-3.10.0-327.84.1.el7'
    'kernel-3.10.0-327.85.1.el7'
    'kernel-3.10.0-327.86.1.el7'
    'kernel-3.10.0-327.88.1.el7'
    'kernel-3.10.0-327.89.1.el7'
    'kernel-3.10.0-327.90.2.el7'
    'kernel-3.10.0-327.92.1.el7'
    'kernel-3.10.0-327.93.1.el7'
    'kernel-3.10.0-327.94.1.el7'
    'kernel-3.10.0-327.96.1.el7'
    'kernel-3.10.0-327.97.1.el7'
    'kernel-3.10.0-327.el7'
    'kernel-3.10.0-514.2.2.el7'
    'kernel-3.10.0-514.6.1.el7'
    'kernel-3.10.0-514.6.2.el7'
    'kernel-3.10.0-514.10.2.el7'
    'kernel-3.10.0-514.16.1.el7'
    'kernel-3.10.0-514.16.2.p7ih.el7'
    'kernel-3.10.0-514.21.1.el7'
    'kernel-3.10.0-514.21.2.el7'
    'kernel-3.10.0-514.26.1.el7'
    'kernel-3.10.0-514.26.2.el7'
    'kernel-3.10.0-514.28.1.el7'
    'kernel-3.10.0-514.28.2.el7'
    'kernel-3.10.0-514.32.2.el7'
    'kernel-3.10.0-514.32.3.el7'
    'kernel-3.10.0-514.35.1.el7'
    'kernel-3.10.0-514.36.1.el7'
    'kernel-3.10.0-514.36.5.el7'
    'kernel-3.10.0-514.41.1.el7'
    'kernel-3.10.0-514.44.1.el7'
    'kernel-3.10.0-514.48.1.el7'
    'kernel-3.10.0-514.48.3.el7'
    'kernel-3.10.0-514.48.5.el7'
    'kernel-3.10.0-514.51.1.el7'
    'kernel-3.10.0-514.53.1.el7'
    'kernel-3.10.0-514.55.4.el7'
    'kernel-3.10.0-514.58.1.el7'
    'kernel-3.10.0-514.61.1.el7'
    'kernel-3.10.0-514.62.1.el7'
    'kernel-3.10.0-514.63.1.el7'
    'kernel-3.10.0-514.64.2.el7'
    'kernel-3.10.0-514.66.2.el7'
    'kernel-3.10.0-514.69.1.el7'
    'kernel-3.10.0-514.70.1.el7'
    'kernel-3.10.0-514.70.2.el7'
    'kernel-3.10.0-514.70.3.el7'
    'kernel-3.10.0-514.71.1.el7'
    'kernel-3.10.0-514.72.1.el7'
    'kernel-3.10.0-514.73.1.el7'
    'kernel-3.10.0-514.74.1.el7'
    'kernel-3.10.0-514.76.1.el7'
    'kernel-3.10.0-514.78.1.el7'
    'kernel-3.10.0-514.79.2.el7'
    'kernel-3.10.0-514.83.1.el7'
    'kernel-3.10.0-514.85.1.el7'
    'kernel-3.10.0-514.86.1.el7'
    'kernel-3.10.0-514.88.1.el7'
    'kernel-3.10.0-514.89.1.el7'
    'kernel-3.10.0-514.el7'
    'kernel-3.10.0-693.1.1.el7'
    'kernel-3.10.0-693.2.1.el7'
    'kernel-3.10.0-693.2.2.el7'
    'kernel-3.10.0-693.5.2.el7'
    'kernel-3.10.0-693.5.2.p7ih.el7'
    'kernel-3.10.0-693.11.1.el7'
    'kernel-3.10.0-693.11.6.el7'
    'kernel-3.10.0-693.17.1.el7'
    'kernel-3.10.0-693.21.1.el7'
    'kernel-3.10.0-693.25.2.el7'
    'kernel-3.10.0-693.25.4.el7'
    'kernel-3.10.0-693.25.7.el7'
    'kernel-3.10.0-693.33.1.el7'
    'kernel-3.10.0-693.35.1.el7'
    'kernel-3.10.0-693.37.4.el7'
    'kernel-3.10.0-693.39.1.el7'
    'kernel-3.10.0-693.43.1.el7'
    'kernel-3.10.0-693.44.1.el7'
    'kernel-3.10.0-693.46.1.el7'
    'kernel-3.10.0-693.47.2.el7'
    'kernel-3.10.0-693.50.3.el7'
    'kernel-3.10.0-693.55.1.el7'
    'kernel-3.10.0-693.58.1.el7'
    'kernel-3.10.0-693.59.1.el7'
    'kernel-3.10.0-693.60.1.el7'
    'kernel-3.10.0-693.60.2.el7'
    'kernel-3.10.0-693.60.3.el7'
    'kernel-3.10.0-693.61.1.el7'
    'kernel-3.10.0-693.62.1.el7'
    'kernel-3.10.0-693.64.1.el7'
    'kernel-3.10.0-693.65.1.el7'
    'kernel-3.10.0-693.67.1.el7'
    'kernel-3.10.0-693.69.1.el7'
    'kernel-3.10.0-693.71.2.el7'
    'kernel-3.10.0-693.72.1.el7'
    'kernel-3.10.0-693.76.1.el7'
    'kernel-3.10.0-693.77.1.el7'
    'kernel-3.10.0-693.81.1.el7'
    'kernel-3.10.0-693.82.1.el7'
    'kernel-3.10.0-693.84.1.el7'
    'kernel-3.10.0-693.87.1.el7'
    'kernel-3.10.0-693.el7'
    'kernel-3.10.0-861.el7'
    'kernel-3.10.0-862.2.3.el7'
    'kernel-3.10.0-862.3.2.el7'
    'kernel-3.10.0-862.3.3.el7'
    'kernel-3.10.0-862.6.3.el7'
    'kernel-3.10.0-862.9.1.el7'
    'kernel-3.10.0-862.11.6.el7'
    'kernel-3.10.0-862.14.4.el7'
    'kernel-3.10.0-862.20.2.el7'
    'kernel-3.10.0-862.25.3.el7'
    'kernel-3.10.0-862.27.1.el7'
    'kernel-3.10.0-862.29.1.el7'
    'kernel-3.10.0-862.32.1.el7'
    'kernel-3.10.0-862.32.2.el7'
    'kernel-3.10.0-862.34.1.el7'
    'kernel-3.10.0-862.34.2.el7'
    'kernel-3.10.0-862.37.1.el7'
    'kernel-3.10.0-862.41.1.el7'
    'kernel-3.10.0-862.41.2.el7'
    'kernel-3.10.0-862.43.1.el7'
    'kernel-3.10.0-862.43.2.el7'
    'kernel-3.10.0-862.43.3.el7'
    'kernel-3.10.0-862.44.2.el7'
    'kernel-3.10.0-862.46.1.el7'
    'kernel-3.10.0-862.48.1.el7'
    'kernel-3.10.0-862.51.1.el7'
    'kernel-3.10.0-862.el7'
    'kernel-3.10.0-957.1.3.el7'
    'kernel-3.10.0-957.5.1.el7'
    'kernel-3.10.0-957.10.1.el7'
    'kernel-3.10.0-957.12.1.el7'
    'kernel-3.10.0-957.12.2.el7'
    'kernel-3.10.0-957.21.2.el7'
    'kernel-3.10.0-957.21.3.el7'
    'kernel-3.10.0-957.27.2.el7'
    'kernel-3.10.0-957.27.4.el7'
    'kernel-3.10.0-957.35.1.el7'
    'kernel-3.10.0-957.35.2.el7'
    'kernel-3.10.0-957.38.1.el7'
    'kernel-3.10.0-957.38.2.el7'
    'kernel-3.10.0-957.38.3.el7'
    'kernel-3.10.0-957.41.1.el7'
    'kernel-3.10.0-957.43.1.el7'
    'kernel-3.10.0-957.46.1.el7'
    'kernel-3.10.0-957.48.1.el7'
    'kernel-3.10.0-957.54.1.el7'
    'kernel-3.10.0-957.56.1.el7'
    'kernel-3.10.0-957.58.2.el7'
    'kernel-3.10.0-957.61.1.el7'
    'kernel-3.10.0-957.61.2.el7'
    'kernel-3.10.0-957.62.1.el7'
    'kernel-3.10.0-957.65.1.el7'
    'kernel-3.10.0-957.66.1.el7'
    'kernel-3.10.0-957.70.1.el7'
    'kernel-3.10.0-957.72.1.el7'
    'kernel-3.10.0-957.76.1.el7'
    'kernel-3.10.0-957.el7'
    'kernel-3.10.0-1062.1.1.el7'
    'kernel-3.10.0-1062.1.2.el7'
    'kernel-3.10.0-1062.4.1.el7'
    'kernel-3.10.0-1062.4.2.el7'
    'kernel-3.10.0-1062.4.3.el7'
    'kernel-3.10.0-1062.7.1.el7'
    'kernel-3.10.0-1062.9.1.el7'
    'kernel-3.10.0-1062.12.1.el7'
    'kernel-3.10.0-1062.18.1.el7'
    'kernel-3.10.0-1062.21.1.el7'
    'kernel-3.10.0-1062.26.1.el7'
    'kernel-3.10.0-1062.30.1.el7'
    'kernel-3.10.0-1062.31.2.el7'
    'kernel-3.10.0-1062.31.3.el7'
    'kernel-3.10.0-1062.33.1.el7'
    'kernel-3.10.0-1062.36.1.el7'
    'kernel-3.10.0-1062.37.1.el7'
    'kernel-3.10.0-1062.40.1.el7'
    'kernel-3.10.0-1062.43.1.el7'
    'kernel-3.10.0-1062.45.1.el7'
    'kernel-3.10.0-1062.46.1.el7'
    'kernel-3.10.0-1062.49.1.el7'
    'kernel-3.10.0-1062.51.1.el7'
    'kernel-3.10.0-1062.el7'
    'kernel-3.10.0-1127.8.2.el7'
    'kernel-3.10.0-1127.10.1.el7'
    'kernel-3.10.0-1127.13.1.el7'
    'kernel-3.10.0-1127.18.2.el7'
    'kernel-3.10.0-1127.19.1.el7'
    'kernel-3.10.0-1127.el7'
    'kernel-3.10.0-1136.el7'
    'kernel-3.10.0-1149.el7'
    'kernel-3.10.0-1152.el7'
    'kernel-3.10.0-1160.2.1.el7'
    'kernel-3.10.0-1160.2.2.el7'
    'kernel-3.10.0-1160.6.1.el7'
    'kernel-3.10.0-1160.11.1.el7'
    'kernel-3.10.0-1160.15.2.el7'
    'kernel-3.10.0-1160.21.1.el7'
    'kernel-3.10.0-1160.24.1.el7'
    'kernel-3.10.0-1160.25.1.el7'
    'kernel-3.10.0-1160.31.1.el7'
    'kernel-3.10.0-1160.el7'
    'kernel-3.10.0-229.1.2.ael7b'
    'kernel-3.10.0-229.4.2.ael7b'
    'kernel-3.10.0-229.7.2.ael7b'
    'kernel-3.10.0-229.11.1.ael7b'
    'kernel-3.10.0-229.14.1.ael7b'
    'kernel-3.10.0-229.20.1.ael7b'
    'kernel-3.10.0-229.24.2.ael7b'
    'kernel-3.10.0-229.26.2.ael7b'
    'kernel-3.10.0-229.28.1.ael7b'
    'kernel-3.10.0-229.30.1.ael7b'
    'kernel-3.10.0-229.34.1.ael7b'
    'kernel-3.10.0-229.38.1.ael7b'
    'kernel-3.10.0-229.40.1.ael7b'
    'kernel-3.10.0-229.42.1.ael7b'
    'kernel-3.10.0-229.42.2.ael7b'
    'kernel-3.10.0-229.44.1.ael7b'
    'kernel-3.10.0-229.46.1.ael7b'
    'kernel-3.10.0-229.48.1.ael7b'
    'kernel-3.10.0-229.49.1.ael7b'
    'kernel-3.10.0-229.ael7b'
    'kernel-4.11.0-44.2.1.el7a'
    'kernel-4.11.0-44.4.1.el7a'
    'kernel-4.11.0-44.6.1.el7a'
    'kernel-4.11.0-44.7.1.el7a'
    'kernel-4.11.0-44.el7a'
    'kernel-4.14.0-49.2.2.el7a'
    'kernel-4.14.0-49.8.1.el7a'
    'kernel-4.14.0-49.10.1.el7a'
    'kernel-4.14.0-49.13.1.el7a'
    'kernel-4.14.0-49.el7a'
    'kernel-4.14.0-104.el7a'
    'kernel-4.14.0-115.2.2.el7a'
    'kernel-4.14.0-115.5.1.el7a'
    'kernel-4.14.0-115.6.1.el7a'
    'kernel-4.14.0-115.7.1.el7a'
    'kernel-4.14.0-115.8.1.el7a'
    'kernel-4.14.0-115.8.2.el7a'
    'kernel-4.14.0-115.10.1.el7a'
    'kernel-4.14.0-115.12.1.el7a'
    'kernel-4.14.0-115.13.1.el7a'
    'kernel-4.14.0-115.14.1.el7a'
    'kernel-4.14.0-115.16.1.el7a'
    'kernel-4.14.0-115.17.1.el7a'
    'kernel-4.14.0-115.18.1.el7a'
    'kernel-4.14.0-115.19.1.el7a'
    'kernel-4.14.0-115.21.2.el7a'
    'kernel-4.14.0-115.26.1.el7a'
    'kernel-4.14.0-115.29.1.el7a'
    'kernel-4.14.0-115.32.1.el7a'
    'kernel-4.14.0-115.33.1.el7a'
    'kernel-4.14.0-115.35.1.el7a'
    'kernel-4.14.0-115.36.1.el7a'
    'kernel-4.14.0-115.el7a'
    'kernel-4.18.0-80.1.2.el8_0'
    'kernel-4.18.0-80.4.2.el8_0'
    'kernel-4.18.0-80.7.1.el8_0'
    'kernel-4.18.0-80.7.2.el8_0'
    'kernel-4.18.0-80.11.1.el8_0'
    'kernel-4.18.0-80.11.2.el8_0'
    'kernel-4.18.0-80.15.1.el8_0'
    'kernel-4.18.0-80.16.1.el8_0'
    'kernel-4.18.0-80.18.1.el8_0'
    'kernel-4.18.0-80.23.2.el8_0'
    'kernel-4.18.0-80.27.1.el8_0'
    'kernel-4.18.0-80.27.2.el8_0'
    'kernel-4.18.0-80.29.1.el8_0'
    'kernel-4.18.0-80.30.1.el8_0'
    'kernel-4.18.0-80.31.1.el8_0'
    'kernel-4.18.0-80.el8'
    'kernel-4.18.0-147.0.2.el8_1'
    'kernel-4.18.0-147.0.3.el8_1'
    'kernel-4.18.0-147.3.1.el8_1'
    'kernel-4.18.0-147.5.1.el8_1'
    'kernel-4.18.0-147.8.1.el8_1'
    'kernel-4.18.0-147.13.2.el8_1'
    'kernel-4.18.0-147.20.1.el8_1'
    'kernel-4.18.0-147.24.2.el8_1'
    'kernel-4.18.0-147.27.1.el8_1'
    'kernel-4.18.0-147.32.1.el8_1'
    'kernel-4.18.0-147.34.1.el8_1'
    'kernel-4.18.0-147.38.1.el8_1'
    'kernel-4.18.0-147.43.1.el8_1'
    'kernel-4.18.0-147.44.1.el8_1'
    'kernel-4.18.0-147.48.1.el8_1'
    'kernel-4.18.0-147.51.1.el8_1'
    'kernel-4.18.0-147.el8'
    'kernel-4.18.0-193.1.2.el8_2'
    'kernel-4.18.0-193.6.3.el8_2'
    'kernel-4.18.0-193.12.1.el8_2'
    'kernel-4.18.0-193.13.2.el8_2'
    'kernel-4.18.0-193.14.3.el8_2'
    'kernel-4.18.0-193.19.1.el8_2'
    'kernel-4.18.0-193.23.1.el8_2'
    'kernel-4.18.0-193.24.1.el8_2.dt1'
    'kernel-4.18.0-193.28.1.el8_2'
    'kernel-4.18.0-193.29.1.el8_2'
    'kernel-4.18.0-193.37.1.el8_2'
    'kernel-4.18.0-193.40.1.el8_2'
    'kernel-4.18.0-193.41.1.el8_2'
    'kernel-4.18.0-193.46.1.el8_2'
    'kernel-4.18.0-193.47.1.el8_2'
    'kernel-4.18.0-193.51.1.el8_2'
    'kernel-4.18.0-193.56.1.el8_2'
    'kernel-4.18.0-193.el8'
    'kernel-4.18.0-221.el8'
    'kernel-4.18.0-232.el8'
    'kernel-4.18.0-234.el8'
    'kernel-4.18.0-235.el8'
    'kernel-4.18.0-240.1.1.el8_3'
    'kernel-4.18.0-240.8.1.el8_3'
    'kernel-4.18.0-240.10.1.el8_3'
    'kernel-4.18.0-240.15.1.el8_3'
    'kernel-4.18.0-240.22.1.el8_3'
    'kernel-4.18.0-240.el8'
    'kernel-4.18.0-293.el8'
    'kernel-4.18.0-304.el8'
    'kernel-4.18.0-305.3.1.el8_4'
    'kernel-4.18.0-305.7.1.el8_4'
    'kernel-4.18.0-305.el8'
    'kernel-rt-3.10.0-229.rt56.144.el6rt'
    'kernel-rt-3.10.0-229.rt56.147.el6rt'
    'kernel-rt-3.10.0-229.rt56.149.el6rt'
    'kernel-rt-3.10.0-229.rt56.151.el6rt'
    'kernel-rt-3.10.0-229.rt56.153.el6rt'
    'kernel-rt-3.10.0-229.rt56.158.el6rt'
    'kernel-rt-3.10.0-229.rt56.161.el6rt'
    'kernel-rt-3.10.0-229.rt56.162.el6rt'
    'kernel-rt-3.10.0-327.rt56.170.el6rt'
    'kernel-rt-3.10.0-327.rt56.171.el6rt'
    'kernel-rt-3.10.0-327.rt56.176.el6rt'
    'kernel-rt-3.10.0-327.rt56.183.el6rt'
    'kernel-rt-3.10.0-327.rt56.190.el6rt'
    'kernel-rt-3.10.0-327.rt56.194.el6rt'
    'kernel-rt-3.10.0-327.rt56.195.el6rt'
    'kernel-rt-3.10.0-327.rt56.197.el6rt'
    'kernel-rt-3.10.0-327.rt56.198.el6rt'
    'kernel-rt-3.10.0-327.rt56.199.el6rt'
    'kernel-rt-3.10.0-514.rt56.210.el6rt'
    'kernel-rt-3.10.0-514.rt56.215.el6rt'
    'kernel-rt-3.10.0-514.rt56.219.el6rt'
    'kernel-rt-3.10.0-514.rt56.221.el6rt'
    'kernel-rt-3.10.0-514.rt56.228.el6rt'
    'kernel-rt-3.10.0-514.rt56.231.el6rt'
    'kernel-rt-3.10.0-693.2.1.rt56.585.el6rt'
    'kernel-rt-3.10.0-693.2.2.rt56.588.el6rt'
    'kernel-rt-3.10.0-693.5.2.rt56.592.el6rt'
    'kernel-rt-3.10.0-693.11.1.rt56.597.el6rt'
    'kernel-rt-3.10.0-693.11.1.rt56.606.el6rt'
    'kernel-rt-3.10.0-693.17.1.rt56.604.el6rt'
    'kernel-rt-3.10.0-693.21.1.rt56.607.el6rt'
    'kernel-rt-3.10.0-693.25.2.rt56.612.el6rt'
    'kernel-rt-3.10.0-693.25.4.rt56.613.el6rt'
    'kernel-rt-3.10.0-693.25.7.rt56.615.el6rt'
    'kernel-rt-3.10.0-693.33.1.rt56.621.el6rt'
    'kernel-rt-3.10.0-693.35.1.rt56.625.el6rt'
    'kernel-rt-3.10.0-693.37.4.rt56.629.el6rt'
    'kernel-rt-3.10.0-693.39.1.rt56.629.el6rt'
    'kernel-rt-3.10.0-693.43.1.rt56.630.el6rt'
    'kernel-rt-3.10.0-693.44.1.rt56.633.el6rt'
    'kernel-rt-3.10.0-693.46.1.rt56.639.el6rt'
    'kernel-rt-3.10.0-693.47.2.rt56.641.el6rt'
    'kernel-rt-3.10.0-693.50.3.rt56.644.el6rt'
    'kernel-rt-3.10.0-693.55.1.rt56.649.el6rt'
    'kernel-rt-3.10.0-693.58.1.rt56.652.el6rt'
    'kernel-rt-3.10.0-693.60.1.rt56.654.el6rt'
    'kernel-rt-3.10.0-693.60.2.rt56.655.el6rt'
    'kernel-rt-3.10.0-693.60.3.rt56.655.el6rt'
    'kernel-rt-3.10.0-693.61.1.rt56.656.el6rt'
    'kernel-rt-3.10.0-693.62.1.rt56.659.el6rt'
    'kernel-rt-3.10.0-693.64.1.rt56.662.el6rt'
    'kernel-rt-3.10.0-693.65.1.rt56.663.el6rt'
    'kernel-rt-3.10.0-693.67.1.rt56.665.el6rt'
    'kernel-rt-3.10.0-693.69.1.rt56.667.el6rt'
    'kernel-rt-3.10.0-693.71.2.rt56.670.el6rt'
    'kernel-rt-3.10.0-693.72.1.rt56.672.el6rt'
    'kernel-rt-3.10.0-693.76.1.rt56.676.el6rt'
    'kernel-rt-2.6.33.9-rt31.66.el6rt'
    'kernel-rt-2.6.33.9-rt31.74.el6rt'
    'kernel-rt-2.6.33.9-rt31.75.el6rt'
    'kernel-rt-2.6.33.9-rt31.79.el6rt'
    'kernel-rt-3.0.9-rt26.45.el6rt'
    'kernel-rt-3.0.9-rt26.46.el6rt'
    'kernel-rt-3.0.18-rt34.53.el6rt'
    'kernel-rt-3.0.25-rt44.57.el6rt'
    'kernel-rt-3.0.30-rt50.62.el6rt'
    'kernel-rt-3.0.36-rt57.66.el6rt'
    'kernel-rt-3.2.23-rt37.56.el6rt'
    'kernel-rt-3.2.33-rt50.66.el6rt'
    'kernel-rt-3.6.11-rt28.20.el6rt'
    'kernel-rt-3.6.11-rt30.25.el6rt'
    'kernel-rt-3.6.11.2-rt33.39.el6rt'
    'kernel-rt-3.6.11.5-rt37.55.el6rt'
    'kernel-rt-3.8.13-rt14.20.el6rt'
    'kernel-rt-3.8.13-rt14.25.el6rt'
    'kernel-rt-3.8.13-rt27.33.el6rt'
    'kernel-rt-3.8.13-rt27.34.el6rt'
    'kernel-rt-3.8.13-rt27.40.el6rt'
    'kernel-rt-3.10.33-rt32.33.el6rt'
    'kernel-rt-3.10.33-rt32.34.el6rt'
    'kernel-rt-3.10.33-rt32.43.el6rt'
    'kernel-rt-3.10.33-rt32.45.el6rt'
    'kernel-rt-3.10.33-rt32.51.el6rt'
    'kernel-rt-3.10.33-rt32.52.el6rt'
    'kernel-rt-3.10.58-rt62.58.el6rt'
    'kernel-rt-3.10.58-rt62.60.el6rt'
    'kernel-rt-3.10.0-229.1.2.rt56.141.2.el7_1'
    'kernel-rt-3.10.0-229.4.2.rt56.141.6.el7_1'
    'kernel-rt-3.10.0-229.7.2.rt56.141.6.el7_1'
    'kernel-rt-3.10.0-229.11.1.rt56.141.11.el7_1'
    'kernel-rt-3.10.0-229.14.1.rt56.141.13.el7_1'
    'kernel-rt-3.10.0-229.20.1.rt56.141.14.el7_1'
    'kernel-rt-3.10.0-229.rt56.141.el7'
    'kernel-rt-3.10.0-327.4.5.rt56.206.el7_2'
    'kernel-rt-3.10.0-327.10.1.rt56.211.el7_2'
    'kernel-rt-3.10.0-327.13.1.rt56.216.el7_2'
    'kernel-rt-3.10.0-327.18.2.rt56.223.el7_2'
    'kernel-rt-3.10.0-327.22.2.rt56.230.el7_2'
    'kernel-rt-3.10.0-327.28.2.rt56.234.el7_2'
    'kernel-rt-3.10.0-327.28.3.rt56.235.el7'
    'kernel-rt-3.10.0-327.36.1.rt56.237.el7'
    'kernel-rt-3.10.0-327.36.3.rt56.238.el7'
    'kernel-rt-3.10.0-327.rt56.204.el7'
    'kernel-rt-3.10.0-514.2.2.rt56.424.el7'
    'kernel-rt-3.10.0-514.6.1.rt56.429.el7'
    'kernel-rt-3.10.0-514.6.1.rt56.430.el7'
    'kernel-rt-3.10.0-514.10.2.rt56.435.el7'
    'kernel-rt-3.10.0-514.16.1.rt56.437.el7'
    'kernel-rt-3.10.0-514.21.1.rt56.438.el7'
    'kernel-rt-3.10.0-514.26.1.rt56.442.el7'
    'kernel-rt-3.10.0-514.rt56.420.el7'
    'kernel-rt-3.10.0-693.2.1.rt56.620.el7'
    'kernel-rt-3.10.0-693.2.2.rt56.623.el7'
    'kernel-rt-3.10.0-693.5.2.rt56.626.el7'
    'kernel-rt-3.10.0-693.11.1.rt56.632.el7'
    'kernel-rt-3.10.0-693.11.1.rt56.639.el7'
    'kernel-rt-3.10.0-693.17.1.rt56.636.el7'
    'kernel-rt-3.10.0-693.21.1.rt56.639.el7'
    'kernel-rt-3.10.0-693.rt56.617.el7'
    'kernel-rt-3.10.0-861.rt56.803.el7'
    'kernel-rt-3.10.0-862.2.3.rt56.806.el7'
    'kernel-rt-3.10.0-862.3.2.rt56.808.el7'
    'kernel-rt-3.10.0-862.3.3.rt56.809.el7'
    'kernel-rt-3.10.0-862.6.3.rt56.811.el7'
    'kernel-rt-3.10.0-862.11.6.rt56.819.el7'
    'kernel-rt-3.10.0-862.14.4.rt56.821.el7'
    'kernel-rt-3.10.0-862.rt56.804.el7'
    'kernel-rt-3.10.0-957.1.3.rt56.913.el7'
    'kernel-rt-3.10.0-957.5.1.rt56.916.el7'
    'kernel-rt-3.10.0-957.10.1.rt56.921.el7'
    'kernel-rt-3.10.0-957.12.1.rt56.927.el7'
    'kernel-rt-3.10.0-957.12.2.rt56.929.el7'
    'kernel-rt-3.10.0-957.21.2.rt56.934.el7'
    'kernel-rt-3.10.0-957.21.3.rt56.935.el7'
    'kernel-rt-3.10.0-957.27.2.rt56.940.el7'
    'kernel-rt-3.10.0-957.rt56.910.el7'
    'kernel-rt-3.10.0-1062.1.1.rt56.1024.el7'
    'kernel-rt-3.10.0-1062.1.2.rt56.1025.el7'
    'kernel-rt-3.10.0-1062.4.1.rt56.1027.el7'
    'kernel-rt-3.10.0-1062.4.2.rt56.1028.el7'
    'kernel-rt-3.10.0-1062.4.3.rt56.1029.el7'
    'kernel-rt-3.10.0-1062.7.1.rt56.1030.el7'
    'kernel-rt-3.10.0-1062.9.1.rt56.1033.el7'
    'kernel-rt-3.10.0-1062.12.1.rt56.1042.el7'
    'kernel-rt-3.10.0-1062.18.1.rt56.1044.el7'
    'kernel-rt-3.10.0-1062.rt56.1022.el7'
    'kernel-rt-3.10.0-1127.8.2.rt56.1103.el7'
    'kernel-rt-3.10.0-1127.10.1.rt56.1106.el7'
    'kernel-rt-3.10.0-1127.13.1.rt56.1110.el7'
    'kernel-rt-3.10.0-1127.18.2.rt56.1116.el7'
    'kernel-rt-3.10.0-1127.19.1.rt56.1116.el7'
    'kernel-rt-3.10.0-1127.rt56.1093.el7'
    'kernel-rt-3.10.0-1136.rt56.1107.el7'
    'kernel-rt-3.10.0-1160.2.1.rt56.1133.el7'
    'kernel-rt-3.10.0-1160.2.2.rt56.1134.el7'
    'kernel-rt-3.10.0-1160.6.1.rt56.1139.el7'
    'kernel-rt-3.10.0-1160.11.1.rt56.1145.el7'
    'kernel-rt-3.10.0-1160.15.2.rt56.1152.el7'
    'kernel-rt-3.10.0-1160.21.1.rt56.1158.el7'
    'kernel-rt-3.10.0-1160.24.1.rt56.1161.el7'
    'kernel-rt-3.10.0-1160.25.1.rt56.1162.el7'
    'kernel-rt-3.10.0-1160.31.1.rt56.1169.el7'
    'kernel-rt-3.10.0-1160.rt56.1131.el7'
    'kernel-rt-4.18.0-80.1.2.rt9.145.el8_0'
    'kernel-rt-4.18.0-80.4.2.rt9.152.el8_0'
    'kernel-rt-4.18.0-80.7.1.rt9.153.el8_0'
    'kernel-rt-4.18.0-80.7.2.rt9.154.el8_0'
    'kernel-rt-4.18.0-80.11.1.rt9.156.el8_0'
    'kernel-rt-4.18.0-80.11.2.rt9.157.el8_0'
    'kernel-rt-4.18.0-80.rt9.138.el8'
    'kernel-rt-4.18.0-147.0.2.rt24.94.el8_1'
    'kernel-rt-4.18.0-147.0.3.rt24.95.el8_1'
    'kernel-rt-4.18.0-147.3.1.rt24.96.el8_1'
    'kernel-rt-4.18.0-147.5.1.rt24.98.el8_1'
    'kernel-rt-4.18.0-147.8.1.rt24.101.el8_1'
    'kernel-rt-4.18.0-147.rt24.93.el8'
    'kernel-rt-4.18.0-193.1.2.rt13.53.el8_2'
    'kernel-rt-4.18.0-193.6.3.rt13.59.el8_2'
    'kernel-rt-4.18.0-193.12.1.rt13.63.el8_2'
    'kernel-rt-4.18.0-193.13.2.rt13.65.el8_2'
    'kernel-rt-4.18.0-193.14.3.rt13.67.el8_2'
    'kernel-rt-4.18.0-193.19.1.rt13.70.el8_2'
    'kernel-rt-4.18.0-193.24.1.rt13.74.el8_2.dt1'
    'kernel-rt-4.18.0-193.28.1.rt13.77.el8_2'
    'kernel-rt-4.18.0-193.29.1.rt13.78.el8_2'
    'kernel-rt-4.18.0-193.37.1.rt13.87.el8_2'
    'kernel-rt-4.18.0-193.40.1.rt13.90.el8_2'
    'kernel-rt-4.18.0-193.41.1.rt13.91.el8_2'
    'kernel-rt-4.18.0-193.46.1.rt13.96.el8_2'
    'kernel-rt-4.18.0-193.47.1.rt13.97.el8_2'
    'kernel-rt-4.18.0-193.51.1.rt13.101.el8_2'
    'kernel-rt-4.18.0-193.56.1.rt13.106.el8_2'
    'kernel-rt-4.18.0-193.rt13.51.el8'
    'kernel-rt-4.18.0-221.rt7.33.el8'
    'kernel-rt-4.18.0-232.rt7.44.el8'
    'kernel-rt-4.18.0-234.rt7.46.el8'
    'kernel-rt-4.18.0-235.rt7.48.el8'
    'kernel-rt-4.18.0-240.1.1.rt7.55.el8_3'
    'kernel-rt-4.18.0-240.8.1.rt7.62.el8_3'
    'kernel-rt-4.18.0-240.10.1.rt7.64.el8_3'
    'kernel-rt-4.18.0-240.15.1.rt7.69.el8_3'
    'kernel-rt-4.18.0-240.22.1.rt7.77.el8_3'
    'kernel-rt-4.18.0-240.rt7.54.el8'
    'kernel-rt-4.18.0-293.rt7.59.el8'
    'kernel-rt-4.18.0-304.rt7.71.el8'
    'kernel-rt-4.18.0-305.3.1.rt7.75.el8_4'
    'kernel-rt-4.18.0-305.7.1.rt7.79.el8_4'
    'kernel-rt-4.18.0-305.rt7.72.el8'
)

VULNERABLE_VERSIONS_SYSTEMD=(
    'systemd-239-13.el8'
    'systemd-239-13.el8_0.3'
    'systemd-239-13.el8_0.5'
    'systemd-239-13.el8_0.7'
    'systemd-239-18.el8'
    'systemd-239-18.el8_1.1'
    'systemd-239-18.el8_1.2'
    'systemd-239-18.el8_1.4'
    'systemd-239-18.el8_1.5'
    'systemd-239-18.el8_1.6'
    'systemd-239-18.el8_1.7'
    'systemd-239-27.el8'
    'systemd-239-29.el8'
    'systemd-239-30.el8_2'
    'systemd-239-31.el8_2.2'
    'systemd-239-31.el8_2.3'
    'systemd-239-36.el8'
    'systemd-239-39.el8'
    'systemd-239-40.el8'
    'systemd-239-41.el8_3.1'
    'systemd-239-41.el8_3.2'
    'systemd-239-41.el8_3'
    'systemd-239-44.el8'
    'systemd-239-45.el8'
    'systemd-239-45.el8_4.1'
)

KPATCH_MODULE_NAMES=(
    'kpatch_3_10_0_1160_1_7'
    'kpatch_3_10_0_1160_2_1_1_7'
    'kpatch_3_10_0_1160_2_2_1_7'
    'kpatch_3_10_0_1160_6_1_1_7'
    'kpatch_3_10_0_1160_11_1_1_6'
    'kpatch_3_10_0_1160_15_2_1_6'
    'kpatch_3_10_0_1160_21_1_1_4'
    'kpatch_3_10_0_1160_24_1_1_2'
    'kpatch_3_10_0_1160_25_1_1_2'
    'kpatch_3_10_0_1160_31_1_1_1'
    'kpatch_3_10_0_1062_30_1_1_4'
    'kpatch_3_10_0_1062_31_2_1_4'
    'kpatch_3_10_0_1062_31_3_1_4'
    'kpatch_3_10_0_1062_33_1_1_4'
    'kpatch_3_10_0_1062_36_1_1_4'
    'kpatch_3_10_0_1062_37_1_1_4'
    'kpatch_3_10_0_1062_40_1_1_4'
    'kpatch_3_10_0_1062_43_1_1_4'
    'kpatch_3_10_0_1062_45_1_1_4'
    'kpatch_3_10_0_1062_46_1_1_3'
    'kpatch_3_10_0_1062_49_1_1_1'
    'kpatch_3_10_0_1062_51_1_1_1'
    'kpatch_3_10_0_957_56_1_1_4'
    'kpatch_3_10_0_957_58_2_1_4'
    'kpatch_3_10_0_957_61_1_1_4'
    'kpatch_3_10_0_957_61_2_1_4'
    'kpatch_3_10_0_957_62_1_1_4'
    'kpatch_3_10_0_957_65_1_1_4'
    'kpatch_3_10_0_957_66_1_1_4'
    'kpatch_3_10_0_957_70_1_1_3'
    'kpatch_3_10_0_957_72_1_1_1'
    'kpatch_3_10_0_957_76_1_1_1'
    'kpatch_4_18_0_147_24_2_1_11'
    'kpatch_4_18_0_147_27_1_1_11'
    'kpatch_4_18_0_147_32_1_1_9'
    'kpatch_4_18_0_147_34_1_1_9'
    'kpatch_4_18_0_147_38_1_1_8'
    'kpatch_4_18_0_147_43_1_1_6'
    'kpatch_4_18_0_147_44_1_1_5'
    'kpatch_4_18_0_147_48_1_1_2'
    'kpatch_4_18_0_147_51_1_1_1'
    'kpatch_4_18_0_193_13_2_1_10'
    'kpatch_4_18_0_193_14_3_1_10'
    'kpatch_4_18_0_193_19_1_1_10'
    'kpatch_4_18_0_193_28_1_1_8'
    'kpatch_4_18_0_193_29_1_1_8'
    'kpatch_4_18_0_193_37_1_1_8'
    'kpatch_4_18_0_193_40_1_1_8'
    'kpatch_4_18_0_193_41_1_1_8'
    'kpatch_4_18_0_193_46_1_1_5'
    'kpatch_4_18_0_193_47_1_1_5'
    'kpatch_4_18_0_193_51_1_1_2'
    'kpatch_4_18_0_193_56_1_1_1'
    'kpatch_4_18_0_305_1_3'
    'kpatch_4_18_0_305_3_1_1_2'
    'kpatch_4_18_0_305_7_1_1_1'
)


basic_args() {
    # Parses basic commandline arguments and sets basic environment.
    #
    # Args:
    #     parameters - an array of commandline arguments
    #
    # Side effects:
    #     Exits if --help parameters is used
    #     Sets COLOR constants and debug variable

    local parameters=( "$@" )

    RED="\\033[1;31m"
    GREEN="\\033[1;32m"
    BOLD="\\033[1m"
    RESET="\\033[0m"
    for parameter in "${parameters[@]}"; do
        if [[ "$parameter" == "-h" || "$parameter" == "--help" ]]; then
            echo "Usage: $( basename "$0" ) [-n | --no-colors] [-d | --debug]"
            exit 1
        elif [[ "$parameter" == "-n" || "$parameter" == "--no-colors" ]]; then
            RED=""
            GREEN=""
            BOLD=""
            RESET=""
        elif [[ "$parameter" == "-d" || "$parameter" == "--debug" ]]; then
            debug=true
        fi
    done
}


basic_reqs() {
    # Prints common disclaimer and checks basic requirements.
    #
    # Args:
    #     CVE - string printed in the disclaimer
    #
    # Side effects:
    #     Exits when 'rpm' command is not available

    local CVE="$1"

    # Disclaimer
    echo
    echo -e "${BOLD}This script (v$VERSION) is primarily designed to detect $CVE on supported"
    echo -e "Red Hat Enterprise Linux systems and kernel packages."
    echo -e "Result may be inaccurate for other RPM based systems.${RESET}"
    echo

    # RPM is required
    if ! command -v rpm &> /dev/null; then
        echo "'rpm' command is required, but not installed. Exiting."
        exit 1
    fi
}


check_supported_kernel() {
    # Checks if running kernel is supported.
    #
    # Args:
    #     running_kernel - kernel string as returned by 'uname -r'
    #
    # Side effects:
    #     Exits when running kernel is obviously not supported

    local running_kernel="$1"

    # Check supported platform
    if [[ "$running_kernel" != *".el"[6-8]* ]]; then
        echo -e "${RED}This script is meant to be used only on RHEL 6-8.${RESET}"
        exit 1
    fi
}


get_rhel() {
    # Gets RHEL number.
    #
    # Args:
    #     running_kernel - kernel string as returned by 'uname -r'
    #
    # Prints:
    #     RHEL number, e.g. '5', '6', '7', or '8'

    local running_kernel="$1"

    local rhel
    rhel=$( sed -r -n 's/^.*el([[:digit:]]).*$/\1/p' <<< "$running_kernel" )
    echo "$rhel"
}


check_kernel() {
    # checks kernel if it is in list of vulnerable kernels.
    #
    # args:
    #     running_kernel - kernel string as returned by 'uname -r'
    #     vulnerable_versions - an array of vulnerable versions
    #
    # prints:
    #     vulnerable kernel string as returned by 'uname -r', or nothing

    local running_kernel=$1
    shift
    local vulnerable_versions=( "$@" )

    running_kernel=$( sed -r -n 's/^(.*)\..*$/\1/p' <<< "$running_kernel" )
    for tested_kernel in "${vulnerable_versions[@]}"; do
        tested_kernel=$( sed -r -n 's/^(kernel-)?(rt-)?(.*)$/\3/p' <<< "$tested_kernel" )
        if [[ "$running_kernel" == "$tested_kernel" ]]; then
            echo "$running_kernel"
            break
        fi
    done
}


check_kpatch() {
    # checks if specific kpatch listed in a kpatch list is applied.
    #
    # args:
    #     kpatch_module_names - an array of kpatches
    #
    # prints:
    #     found kpatch, or nothing

    local kpatch_module_names=( "$@" )
    local modules

    # get loaded kernel modules
    modules=$( lsmod )

    # check if kpatch is installed
    for tested_kpatch in "${kpatch_module_names[@]}"; do
        if [[ "$modules" == *"$tested_kpatch"* ]]; then
            echo "$tested_kpatch"
            break
        fi
    done
}


check_package() {
    # Checks if installed package is in list of vulnerable packages.
    #
    # Args:
    #     installed_packages - installed packages string as returned by 'rpm -qa package'
    #                          (may be multiline)
    #     vulnerable_versions - an array of vulnerable versions
    #
    # Prints:
    #     First vulnerable package string as returned by 'rpm -qa package', or nothing

    # Convert to array, use word splitting on purpose
    # shellcheck disable=SC2206
    local installed_packages=( $1 )
    shift
    local vulnerable_versions=( "$@" )

    for tested_package in "${vulnerable_versions[@]}"; do
        for installed_package in "${installed_packages[@]}"; do
            installed_package_without_arch="${installed_package%.*}"
            if [[ "$installed_package_without_arch" == "$tested_package" ]]; then
                echo "$installed_package"
                return 0
            fi
        done
    done
}


get_installed_packages() {
    # Checks for installed packages. Compatible with RHEL5.
    #
    # Args:
    #     package_names - an array of package name strings
    #
    # Prints:
    #     Lines with N-V-R.A strings of the installed packages.

    local package_names=( "$@" )

    rpm -qa --queryformat="%{NAME}-%{VERSION}-%{RELEASE}.%{ARCH}\n" "${package_names[@]}"
}


set_default_values() {
    result=0
}


parse_facts() {
    # Gathers all available information and stores it in global variables. Only store facts and
    # do not draw conclusion in this function for better maintainability.
    #
    # Side effects:
    #     Sets many global boolean flags and content variables

    installed_systemd=$( get_installed_packages "systemd" )
    kpatch_installed=$( check_kpatch "${KPATCH_MODULE_NAMES[@]}" )
}

draw_conclusions() {
    # Draws conclusions based on available system data.
    #
    # Side effects:
    #     Sets many global boolean flags and content variables

    vulnerable_kernel=$( check_kernel "$running_kernel" "${VULNERABLE_VERSIONS_KERNEL[@]}" )
    vulnerable_systemd=$( check_package "$installed_systemd" "${VULNERABLE_VERSIONS_SYSTEMD[@]}" )

    if [[ ! $kpatch_installed && $vulnerable_kernel ]]; then
        ((result|=2)) 
    fi

    if [[ $vulnerable_systemd ]]; then
        ((result|=4))
    fi
}


debug_print() {
    # Prints selected variables when debugging is enabled.

    variables=( result rhel running_kernel vulnerable_kernel vulnerable_systemd \
                kpatch_installed installed_systemd )
    for variable in "${variables[@]}"; do
        echo "$variable = *${!variable}*"
    done
    echo
}


if [[ "${BASH_SOURCE[0]}" == "$0" ]]; then
    basic_args "$@"
    basic_reqs "CVE-2021-33909/CVE-2021-33910"

    running_kernel=$( uname -r )
    check_supported_kernel "$running_kernel"
    rhel=$( get_rhel "$running_kernel" )

    set_default_values
    parse_facts
    draw_conclusions

    # Debug prints
    if [[ "$debug" ]]; then
        debug_print
    fi

    # Results
    if (( result != 0 )); then
        if (( ( result & 2 ) != 0 )); then
            echo -e "${RED}This system is vulnerable to CVE-2021-33909.${RESET}"
            echo -e "${RED}The running kernel version is vulnerable.${RESET}"
        else
            echo -e "${GREEN}This system is not vulnerable to CVE-2021-33909.${RESET}"
        fi
        if (( ( result & 4 ) != 0 )); then
            echo -e "${RED}This system is vulnerable to CVE-2021-33910.${RESET}"
            echo -e "${RED}An installed systemd version is vulnerable.${RESET}"
        else
            echo -e "${GREEN}This system is not vulnerable to CVE-2021-33910.${RESET}"
        fi
        echo -e "Follow $BULLETIN for advice."
    else
        echo -e "${GREEN}This system is not vulnerable to CVE-2021-33909 or CVE-2021-33910.${RESET}"
    fi

    exit "$result"
fi
