#!/usr/bin/env bats

. test_harness


VULNERABLE_VERSIONS=(
    'samba3x-3.6.23-13.el5_11'
    'samba4-4.0.0-55.el6.rc4'
)


@test "check_package -- vulnerable #1" {
    run check_package "samba3x-3.6.23-13.el5_11.x86_64" "${VULNERABLE_VERSIONS[@]}"
    [[ "$output" == "samba3x-3.6.23-13.el5_11.x86_64" ]]
}


@test "check_package -- vulnerable #2" {
    run check_package "samba4-4.0.0-55.el6.rc4.x86_64" "${VULNERABLE_VERSIONS[@]}"
    [[ "$output" == "samba4-4.0.0-55.el6.rc4.x86_64" ]]
}


@test "check_package -- not vulnerable" {
    run check_package "samba-3.6.9-168.el6_5.x86_64" "${VULNERABLE_VERSIONS[@]}"
    [[ ! "$output" ]]
}

