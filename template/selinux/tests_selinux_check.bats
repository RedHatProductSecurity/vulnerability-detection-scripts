#!/usr/bin/env bats

. test_harness


@test "selinux_check -- not available" {
    command() { 
        return 1
    }  

    run selinux_check
    (( status == 1 ))
}


@test "selinux_check -- disabled" {
    getenforce() { 
        echo "Disabled"
    }  

    run selinux_check
    (( status == 1 ))
}


@test "selinux_check -- permissive" {
    getenforce() { 
        echo "Permissive"
    }  

    run selinux_check
    (( status == 1 ))
}


@test "selinux_check -- enforcing" {
    getenforce() { 
        echo "Enforcing"
    }  

    run selinux_check
    (( status == 0 ))
}
