#!/usr/bin/env bats

. test_harness


@test "mitigation_check -- not applied" {
    export MOCK_SMB_CONF=file_mocks/samba_not_applied
    run mitigation_check
    (( status == 1 ))
}


@test "mitigation_check -- not applied, yes" {
    export MOCK_SMB_CONF=file_mocks/samba_not_applied_yes
    run mitigation_check
    (( status == 1 ))
}


@test "mitigation_check -- not applied, 1" {
    export MOCK_SMB_CONF=file_mocks/samba_not_applied_1
    run mitigation_check
    (( status == 1 ))
}


@test "mitigation_check -- not applied, true" {
    export MOCK_SMB_CONF=file_mocks/samba_not_applied_true
    run mitigation_check
    (( status == 1 ))
}


@test "mitigation_check -- not applied, on" {
    export MOCK_SMB_CONF=file_mocks/samba_not_applied_on
    run mitigation_check
    (( status == 1 ))
}


@test "mitigation_check -- applied, no" {
    export MOCK_SMB_CONF=file_mocks/samba_applied_no
    run mitigation_check
    (( status == 0 ))
}


@test "mitigation_check -- applied, 0" {
    export MOCK_SMB_CONF=file_mocks/samba_applied_0
    run mitigation_check
    (( status == 0 ))
}


@test "mitigation_check -- applied, false" {
    export MOCK_SMB_CONF=file_mocks/samba_applied_false
    run mitigation_check
    (( status == 0 ))
}


@test "mitigation_check -- applied, off" {
    export MOCK_SMB_CONF=file_mocks/samba_applied_off
    run mitigation_check
    (( status == 0 ))
}


@test "mitigation_check -- applied, different letter case" {
    export MOCK_SMB_CONF=file_mocks/samba_applied_case
    run mitigation_check
    (( status == 0 ))
}

@test "mitigation_check -- applied, but commented out" {
    export MOCK_SMB_CONF=file_mocks/samba_applied_commented
    run mitigation_check
    (( status == 1 ))
}
