export DESCRIPTION="Intel, mitigated but SMT vulnerable"

export MOCK_EUID=0
export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo-skylake
export MOCK_VULN_FILE_PATH=file_mocks/vuln-smt/mds
export MOCK_DMESG_PATH=file_mocks/dmesg-normal


uname() {
    if [[ "$1" == "-m" ]]; then
        echo "x86_64"
        return 0
    fi
    cat file_mocks/uname_r-rhel7
}
export -f uname

dmesg() {
    cat file_mocks/dmesg-normal
}
export -f dmesg

virt-what() {
    printf ""
}
export -f virt-what
