    for required_command in readlink file unzip stat sha256sum basename cat grep uname pwd /bin/rm head ; do
        if ! command -v "$required_command" &> /dev/null; then
            echo "Error: '$required_command' command is required, but not installed. Exiting."
            if [[ "$required_command" == "unzip" ]] ; then
--
    if [[ -d "$tmp_path/$backtrack/$dir_to_delete" && ! -L "$tmp_path/$backtrack/$dir_to_delete"  ]] ; then
        if [[ "$dir_to_delete" != *..* && "$dir_to_delete" != */* ]] ; then
            if [[ "$tmp_path/$backtrack/$dir_to_delete" == "$audit_tmp_path/$backtrack/$dir_to_delete" ]] ; then
                ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${backtrack:?}/${dir_to_delete:?}" ; )
            fi
        fi
    fi
--
    if [[ -d "$tmp_path/$decompressed/$dir_to_delete" && ! -L "$tmp_path/$decompressed/$dir_to_delete"  ]] ; then
        if [[ "$dir_to_delete" != *..* && "$dir_to_delete" != */* ]] ; then
            if [[ "$tmp_path/$decompressed/$dir_to_delete" == "$audit_tmp_path/$decompressed/$dir_to_delete" ]] ; then
                ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${decompressed:?}/${dir_to_delete:?}" ; )
            fi
        fi
    fi
--


        if [[ "$tmp_path/$queue" == "$audit_tmp_path/$queue" ]] ; then
            ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${queue:?}" ; )
        fi

        if [[ "$tmp_path/$catalog" == "$audit_tmp_path/$catalog" ]] ; then
            ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${catalog:?}" ; )
        fi

        if [[ "$tmp_path/$decompressed" == "$audit_tmp_path/$decompressed" ]] ; then
            ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${decompressed:?}" ; )
        fi

        if [[ "$tmp_path/$parents" == "$audit_tmp_path/$parents" ]] ; then
            ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${parents:?}" ; )
        fi

        if [[ "$tmp_path/$backtrack" == "$audit_tmp_path/$backtrack" ]] ; then
            ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${backtrack:?}" ; )
        fi

        if [[ "$tmp_path/$detections" == "$audit_tmp_path/$detections" ]] ; then
            ( cd -- "${audit_tmp_path:?}" && /bin/rm -rf --one-file-system -- "${detections:?}" ; )
        fi

