#!/usr/bin/env bats

. test_harness


@test "basic_args -- Help #1" {
    run basic_args -h
    [[ "$output" == *"Usage"* ]]
    (( status == 1 ))
}


@test "basic_args -- Help #2" {
    run basic_args
    [[ "$output" == *"Usage"* ]]
    (( status == 1 ))
}


@test "basic_args -- Debug #1" {
    basic_args -d --scan "$CANONPWD" --tmp "$CANONPWD"
    (( $? == 0 ))
    (( debug ))
    [[ "$RED" == "\033[1;31m" ]]
    [[ "$GREEN" == "\033[1;32m" ]]
    [[ "$BOLD" == "\033[1m" ]]
    [[ "$RESET" == "\033[0m" ]]
}


@test "basic_args -- Debug #2" {
    basic_args --debug --scan "$CANONPWD" --tmp "$CANONPWD"
    (( $? == 0 ))
    (( debug ))
    [[ "$RED" == "\033[1;31m" ]]
    [[ "$GREEN" == "\033[1;32m" ]]
    [[ "$BOLD" == "\033[1m" ]]
    [[ "$RESET" == "\033[0m" ]]
}


@test "basic_args -- No colors #1" {
    basic_args -n --scan "$CANONPWD" --tmp "$CANONPWD"
    (( $? == 0 ))
    (( ! debug ))
    [[ ! "$RED" ]]
    [[ ! "$GREEN" ]]
    [[ ! "$BOLD" ]]
    [[ ! "$RESET" ]]
}


@test "basic_args -- No colors #2" {
    basic_args --no-colors --scan "$CANONPWD" --tmp "$CANONPWD"
    (( $? == 0 ))
    (( ! debug ))
    [[ ! "$RED" ]]
    [[ ! "$GREEN" ]]
    [[ ! "$BOLD" ]]
    [[ ! "$RESET" ]]
}


@test "basic_args -- Regular" {
    basic_args --scan "$CANONPWD" --tmp "$CANONPWD"
    (( $? == 0 ))
    (( ! debug ))
    [[ "$RED" == "\033[1;31m" ]]
    [[ "$GREEN" == "\033[1;32m" ]]
    [[ "$BOLD" == "\033[1m" ]]
    [[ "$RESET" == "\033[0m" ]]
}


@test "basic_args -- nonexistent #1" {
    run basic_args --scan NONEXISTENT --tmp NONEXISTENT
    [[ "$output" == *"Usage"* ]]
    [[ "$output" == *"SCANPATH doesn't exist or is not a directory."* ]]
    (( status == 1 ))
}


