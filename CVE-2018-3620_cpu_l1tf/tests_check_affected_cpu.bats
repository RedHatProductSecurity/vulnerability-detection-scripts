#!/usr/bin/env bats

. test_harness

@test "check_affected_cpu -- affected vendor" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/affect_intel
    run check_affected_cpu
    [[ $output == "Intel" ]]
    (( status == 1 ))
}


@test "check_affected_cpu -- not affected vendor 1" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/not_aff_amd
    run check_affected_cpu
    [[ $output == "AMD" ]]
    (( status == 0 ))
}


@test "check_affected_cpu -- not affected vendor 2" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/not_aff_arm
    run check_affected_cpu
    [[ $output == "Other" ]]
    (( status == 0 ))
}


@test "check_affected_cpu -- not affected vendor 3" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/not_aff_ibm_s390
    run check_affected_cpu
    [[ $output == "Other" ]]
    (( status == 0 ))
}


@test "check_affected_cpu -- not affected vendor 4" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/not_aff_power8
    run check_affected_cpu
    [[ $output == "POWER" ]]
    (( status == 0 ))
}


@test "check_affected_cpu -- not affected vendor 5" {
    export MOCK_CPU_INFO_PATH=file_mocks/cpuinfo/not_aff_aarch64
    run check_affected_cpu
    [[ $output == "Other" ]]
    (( status == 0 ))
}

