#!/usr/bin/env bats

. test_harness


@test "check_transparent_hugepages -- never" {
    MOCK_THP_ENABLED_PATH=file_mocks/hugepages/never

    run check_transparent_hugepages
    [[ "$output" == "never" ]]
}


@test "check_transparent_hugepages -- always" {
    MOCK_THP_ENABLED_PATH=file_mocks/hugepages/always

    run check_transparent_hugepages
    [[ "$output" == "always" ]]
}


@test "check_transparent_hugepages -- madvise" {
    MOCK_THP_ENABLED_PATH=file_mocks/hugepages/madvise

    run check_transparent_hugepages
    [[ "$output" == "madvise" ]]
}

@test "check_transparent_hugepages -- does not exist" {
    MOCK_THP_ENABLED_PATH=file_mocks/asd

    run check_transparent_hugepages
    [[ "$output" == "" ]]
}
